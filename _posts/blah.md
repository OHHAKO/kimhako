---
layout: post
title: "[Next.js] strictNullChecks과 Type Guards를 이용한 안전한 코드"
excerpt: "Next.js 프로젝트를 개발하며 느낀 nextjs의 장점과 특징"
categories: [Next.js]
comments: true
tags: [Next.js]
credit: vercel
creditlink: https://github.com/OHHAKO
---

# Next.js 의 매력에 대하여

> 실무에서 Next.js 프로젝트를 개발한 경험을 토대로 느낀 점을 풀어낸 글입니다.

일단 전 과거에 Angular와 React에 대한 경험이 있어서 nodejs 기반의 웹 개발에 그리 낯선 편은 아니었으나 Next.js를 쓴 목적이 있었기에 개발에 대한 고민은 새로운 것이었습니다.
Next.js는 React를 개발한 vercel팀이 react를 사용하면서 겪은 한계와 성능을 개선시켜 개발한 프레임워크 입니다.

- next.js, 어떤 성능을 고민하여 설계된 프레임워크인가? (웹 속도 최적화,ssr,seo)

구현 방식은 React와 거의 동일하다고 할 수 있습니다. 컴포넌트 기반의 페이지를 구성하는데에 초점을 두었으며 컴포넌트,훅 메서드를 사용할때 react 라이브러리를 import 하여 사용합니다. 조금 다른점이 있다면 클라이언트 부하를 줄이기 위한 내부적으로 다른 동작 방식을 갖고있다는 점과 지원하는 메서드를 갖고 있다는 점 입니다. 이는 유저 경험와 개발자 경험을 개선시키기 위한 vercel팀의 흔적이라고 볼 수 있습니다.

## SSR(Server-side Rendering)

컴포넌트 렌더링 방식은 크게 두가지로 나눌 수 있습니다. Client-side Rendering(CSR)은 브라우저에서 마크업이나 javaScript 문법을 해석하여 컴포넌트를 렌더링 합니다. SSR은 서버에서 미리 렌더링을 하고 생성한 파일을 클라이언트에게 전송합니다. Next.js는 유저의 요청이 서버에 도착할때 마다 렌더링을 하는것이 아니라 이전에 만들어진 파일을 재사용 하기 때문에 유저는 빠른 응답을 받을 수 있습니다.
명령어를 이용해 Next.js 프로젝트를 처음 생성하면 root에 만들어진 pages라는 폴더를 확인할 수 있습니다. 이 하위 폴더에 생성된 컴포넌트는 next가 빌드타임에 static으로 미리 만들어 놓기 때문에 URL 경로를 이용하면 해당 페이지에 즉각 접근할 수 있습니다. 이 SSR을 이용했을때 UX 측면에서 얻을 수 있는 장점이 크게 두 가지 있는 것 같습니다.

## 웹 속도 최적화의 측면

next.js로 구현한 웹 사이트는 속도 면에서 성능이 뛰어날 수 밖에 없습니다. `pages` 하위 폴더에 생성한 컴포넌트를 next가 빌드타임에 미리 만들어 놓고 (static으로) page를 클라이언트에게 전송하기 때문이다. 브라우저는 전송받은 page를 paint 합니다. 프로젝트의 규모에 따라서 웹애플리케이션의 초기 로드 속도는 조금씩 차이가 있을 수 있지만 그 이후 발생하는 page 렌더링 속도는 상대적으로 절감 됩니다.
최근 버전 10 출시에서 발표한 기본 기능 업데이트 중 하나는 이미지가 많은 페이지의 `초기 뷰포트` 성능 개선이었습니다. 크롬의 경우 로드 하려는 페이지에서 첫 뷰포트 밖에 있는 이미지 중 30%를 로드하는 정책을 갖고 있습니다. 그 이미지는 유저가 스크롤을 내리지 않으면 볼 일이 없는 데이터이므로 이에 대한 부하를 줄이기 위해 `이미지 컴포넌트` 기능을 만들었습니다. 이미지 컴포넌트를 사용하면 첫 뷰포트의 밖에 있는 이미지는 로드하지 않아 페이지 첫 로딩 속도를 감소시킬 수 있습니다.
(개선사항 펙트 체크) 이미지 컴포넌트에 대해 더 알고싶다면 공식문서를 확인해봅시다.

## 검색엔진 최적화(Searcn Engine Optimization)의 측면

특정 단어를 입력했을때 내 사이트가 나온다면 그건 사이트의 검색엔진 최적화가 매우 잘 된 예시일 것이다. 마케팅과 홍보전략이 중요한 상업 사이트는 seo를 잘 이용하는게 개발자의 매우 중요한 과제라고 할 수 있다. 그런데 next.js가 SSR을 하는거랑 검색 엔진이랑 무슨 관련이 있냐구? 좀..사실 꽤 많이 있습니다.

온갖 도메인 사이트를 돌아다니며 어떤 페이지에 어떤 단어, 글자가 있는지 파악하는 로봇이 있습니다. 이 로봇은 구글, 페이스북 등 검색엔진을 이용하는 플랫폼 마다 존재하여 유저가 검색한 글자를 기반으로 사이트를 샅샅이 뒤지고 찾은 결과를 보여 줍니다. 그런데 사이트를 뒤지는 과정에서 이 로봇은 URL로 접근 가능한 페이지를 대상으로 글자를 검토합니다. 이 말은, url로 접근한 페이지에서 어떤 action을 했을때 동적으로 바뀌는 조각이 있다고 가정했을때 이 조각에 대해서는 알지 못한다는 의미입니다. 이 조각이 어떤 글자를 포함하는지, 어떤 이미지를 포함하는지 말입니다. (여기서 조각은 컴포넌트를 의미함)
아까 위에서 Next.js는 서버에서 컴포넌트를 미리 만들어 놓는다는 이야기를 했습니다. 풀어 설명하자면 어떤 동작이 취해져야만 렌더링 되는 컴포넌트는 로봇이 알 수 없습니다. 그러나 이미 만들어진 컴포넌트는 로봇이 발견할 수 있고 그 컴포넌트에 포함된 글자를 알 수 있겠지요.

웹 기술이 점점 복잡해지고 발전할수록 SEO를 최적화 하는 방법 또한 다양해졌을것입니다. 저도 주니어 개발자로 SEO를 배워가는 입장입니다만 페이지에 포함된 글자를 찾는건 검색 엔진 최적화의 아주 기본적인 방식 같습니다. 또한 플랫폼마다 공통적으로 이용하는 보편적인 방식 같습니다. 이 기본적이고 보편적인 방식을 효율적으로 이용할 수 있도록 하는 SSR을 기반한 애플리케이션이 가지는 큰 장점 이라고 생각합니다.

- 어떤 특징의 사이트에서 더욱 유리하게 작용하나?
- next.js가 그리는 미래는 무엇인가?
